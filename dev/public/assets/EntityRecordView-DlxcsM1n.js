import{C as E}from"./CardWidget-t1ohyxJS.js";import{a as r,o as n,l as d,t as u,c as f,w as c,i as g,g as I,C as m,e as N,R as z,S as A,N as B,O as T,p as L,G as $,s as V,b as o,k as P,f as R,h as S,Q as O,q as D,n as U}from"./Container-DH2J1Vin.js";import{a as F,_ as b,l as Y,r as C,e as q,b as w,c as J}from"./main-CPSzirzt.js";import{a as W,_ as j,l as G,o as H}from"./EasyInput.vue_vue_type_script_setup_true_lang-CTnaj6NF.js";import"./InputPassword.vue_vue_type_script_setup_true_lang-CrvKFhcI.js";const M=r({__name:"DisplayData",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),K=r({__name:"DisplayInt",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),Q=r({__name:"DisplayPassword",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),Z=r({__name:"DisplayBigInt",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),X=r({__name:"DisplayDate",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),ee=r({__name:"DisplayBoolean",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),te=r({__name:"DisplayChoices",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),ae=r({__name:"DisplayMultiChoice",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),le=r({__name:"DisplayText",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),ne=r({__name:"DisplayEmail",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),se=r({__name:"DisplayImage",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),ie=r({__name:"DisplayJSON",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),re=r({__name:"DisplayPhone",props:{value:{},field:{}},setup(a){const e=a;return(t,l)=>(n(),d("div",null,u(e.value),1))}}),oe=r({__name:"DisplayConnection",props:{value:{},field:{},titleValue:{}},setup(a){return(e,t)=>(n(),d("div",null,u(e.titleValue),1))}}),ce={class:"label"},ue=r({__name:"DisplayFieldWrapper",props:{field:{}},setup(a){return(e,t)=>(n(),f(m,null,{default:c(()=>[g("div",ce,u(e.field.label),1),I(e.$slots,"default")]),_:3}))}}),de=r({__name:"DisplayField",props:{value:{},field:{},fetchField:{},fetchValue:{}},setup(a){const e={IDField:M,DataField:M,IntField:K,BigIntField:Z,DateField:X,BooleanField:ee,PasswordField:Q,ChoicesField:te,MultiChoiceField:ae,TextField:le,EmailField:ne,ImageField:se,JSONField:ie,PhoneField:re,ConnectionField:oe,TimestampField:W},t=a;return(l,s)=>(n(),f(ue,{field:l.field,class:"display-field"},{default:c(()=>[(n(),f(N(e[t.field.fieldType]),z(A(t)),null,16))]),_:1},8,["field"]))}}),_e=r({__name:"EntityRecordFields",props:{record:{},entityDef:{},edit:{type:Boolean}},setup(a){return(e,t)=>(n(),f(m,{class:L(["entity-fields",{edit:e.edit}])},{default:c(()=>[(n(!0),d(T,null,B(e.entityDef.fields,l=>(n(),d("div",null,[e.edit?(n(),f(j,{key:0,field:l,modelValue:e.record[l.key],"onUpdate:modelValue":s=>e.record[l.key]=s},null,8,["field","modelValue","onUpdate:modelValue"])):(n(),f(de,{key:1,field:l,value:e.record[l.key]},null,8,["field","value"]))]))),256))]),_:1},8,["class"]))}}),pe=g("div",null,[g("div",{class:"title-4"},"Actions")],-1),fe={class:"title-5 text-accent"},me={class:"text-small italic"},ve=r({__name:"EntityActions",props:{entityDef:{},record:{}},setup(a){const e=a,t=$([]);V(()=>{t.value=e.entityDef.actions});function l(s){console.log("handle action",s)}return(s,i)=>(n(),f(P,{class:"row shrink"},{default:c(()=>[pe,o(m,{class:"row shrink"},{default:c(()=>[(n(!0),d(T,null,B(t.value,_=>(n(),f(E,{key:_.key},{default:c(()=>[o(m,{class:"col-2 shrink vertical-align-center"},{default:c(()=>[o(F,{icon:"play_arrow",color:"secondary",onClick:v=>l(_),label:_.label},null,8,["onClick","label"]),o(m,null,{default:c(()=>[g("div",fe,u(_.label),1),g("div",me,u(_.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}});function h(a,e){return a.toString().padStart(2,"0")}function ye(a,e){const t=new Date(a);if(t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),isNaN(t.getTime()))return a;const l=i=>{const _=new Date;let v="",p=i.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});if(e!=null&&e.showSeconds&&(p=i.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})),_.toLocaleDateString()==i.toLocaleDateString())return v="Today at",`${v} ${p}`;if(_.getFullYear()==i.getFullYear()&&i.getMonth().toString()+(i.getDay()+1).toString()==_.getMonth().toString()+_.getDay().toString())return v="Yesterday at",`${v} ${p}`;let y=i.toString().substring(0,15);return e!=null&&e.showSeconds&&(y=i.toString().substring(0,21)),y};switch(e==null?void 0:e.format){case"pretty":return l(t);default:{const i=h(t.getDate()),_=h(t.getMonth()+1),v=t.getFullYear(),p=h(t.getHours()),y=h(t.getMinutes()),k=h(t.getSeconds());return`${i}/${_}/${v} ${p}:${y}${e!=null&&e.showSeconds?`:${k}`:""}`}}}const x=r({__name:"DisplayTimestamp",props:{value:{},field:{}},setup(a){const e=a,t=R(()=>ye(e.value,{format:"pretty"}));return(l,s)=>(n(),d("div",null,u(t.value),1))}}),ge=g("div",{class:"label"},"Created At:",-1),he=g("div",{class:"label"},"Last Updated:",-1),$e=r({__name:"EntityInfo",props:{entityDef:{},record:{}},setup(a){return(e,t)=>(n(),f(m,null,{default:c(()=>[o(m,{class:"col"},{default:c(()=>[ge,o(x,{class:"label text-info-dark",value:e.record.createdAt},null,8,["value"])]),_:1}),o(m,{class:"col"},{default:c(()=>[he,o(x,{class:"label text-info-dark",value:e.record.updatedAt},null,8,["value"])]),_:1})]),_:1}))}}),De=r({__name:"EntityToolbar",props:{editMode:{type:Boolean}},emits:["edit","save","delete"],setup(a,{emit:e}){const t=e,l=a;return G(s=>{H(s,()=>{l.editMode&&t("save")})}),(s,i)=>(n(),f(m,{class:"toolbar col shrink"},{default:c(()=>[o(b,{speed:"fast"},{default:c(()=>[s.editMode?(n(),f(F,{key:0,icon:"save",size:"1",color:"success",onClick:i[0]||(i[0]=_=>s.$emit("save"))})):S("",!0)]),_:1}),o(b,{speed:"fast"},{default:c(()=>[s.editMode?(n(),f(F,{key:0,onClick:i[1]||(i[1]=_=>s.$emit("delete")),icon:"delete",size:"1",color:"error"})):S("",!0)]),_:1}),o(F,{onClick:i[2]||(i[2]=_=>s.$emit("edit",!s.editMode)),icon:s.editMode?"edit_off":"edit",label:"Edit Mode",color:"warning",size:"1"},null,8,["icon"])]),_:1}))}}),Fe={class:"title-4"},ke={class:"text-small italic text-primary-bright"},xe=r({__name:"EntityRecordView",props:{entity:{},id:{}},setup(a){const e=a;let t={};const l=$(),s={loaded:$(!1),saving:$(!1)},i=$(!1);async function _(){s.loaded.value=!1,l.value=await w.getEntity(e.entity,e.id),s.loaded.value=!0}async function v(){if(!l.value)return;s.saving.value=!0;const p=l.value;await w.updateEntity(e.entity,p.id,p),s.saving.value=!1}return Y(e.entity,"update",async p=>{p.id===e.id&&(l.value=p,U({message:`${t.label} ${l.value[t.titleField||"id"]} was updated`,title:`${t.label} Updated`,type:"success"}))}),O(()=>{if(!e.id||!e.entity)return C.push("/entity");const p=q.getDef(e.entity);if(!p)return C.push("/entity");t=p}),V(async()=>{await _()}),(p,y)=>(n(),f(b,null,{default:c(()=>[s.loaded.value?(n(),f(P,{key:0,class:"position-relative entity-record-grid"},{default:c(()=>[o(m,{class:"top-bar col shrink vertical-align-center horizontal-align-between"},{default:c(()=>[o(m,null,{default:c(()=>[g("div",Fe,u(l.value[D(t).titleField||"id"]),1),g("div",ke,u(l.value.id),1)]),_:1}),o(De,{editMode:i.value,onSave:v,onDelete:y[0]||(y[0]=()=>{}),onEdit:y[1]||(y[1]=k=>i.value=k)},null,8,["editMode"])]),_:1}),o(E,{class:"fields"},{default:c(()=>[o(_e,{edit:i.value,record:l.value,entityDef:D(t)},null,8,["edit","record","entityDef"])]),_:1}),o(m,{class:"info"},{default:c(()=>[o($e,{entityDef:D(t),record:l.value},null,8,["entityDef","record"])]),_:1}),o(m,{class:"actions"},{default:c(()=>[o(ve,{entityDef:D(t),record:l.value},null,8,["entityDef","record"])]),_:1}),o(J,{loaded:!s.saving.value},null,8,["loaded"])]),_:1})):S("",!0)]),_:1}))}});export{xe as default};
