import{a as c,G as $,s as V,o as s,c as _,w as i,b as n,l as r,N as g,O as k,C as d,k as F,i as y,t as u,n as N,h as b,p as S,e as z,q as h,V as T}from"./RootLayout.vue_vue_type_style_index_0_lang-Br_nyGRA.js";import{a as C,b as w,_ as x,l as G,r as E,e as O,c as R}from"./main-C9svN23Z.js";import{C as P}from"./CardWidget-N1jG415S.js";import{_ as B,l as J,o as L,a as U}from"./InputTimestamp.vue_vue_type_script_setup_true_lang-CaKCJ3dB.js";import"./InputWrapper.vue_vue_type_script_setup_true_lang-CwPPx3d0.js";const j=y("div",null,[y("div",{class:"title-4"},"Actions")],-1),q={class:"title-5 text-accent"},K={class:"text-small italic"},W=c({__name:"EntityActions",props:{entityDef:{},record:{}},setup(l){const e=l,a=$([]);V(()=>{a.value=e.entityDef.actions});async function t(o){const p=await w.runEntityAction(e.entityDef.entityId,e.record.id,o.key,{});N({title:`Action ${o.label||o.key} completed`,message:p,type:"success"})}return(o,p)=>(s(),_(F,{class:"row shrink"},{default:i(()=>[j,n(d,{class:"row shrink"},{default:i(()=>[(s(!0),r(k,null,g(a.value,v=>(s(),_(P,{key:v.key},{default:i(()=>[n(d,{class:"col-2 shrink vertical-align-center"},{default:i(()=>[n(C,{icon:"play_arrow",color:"secondary",onClick:M=>t(v),label:v.label},null,8,["onClick","label"]),n(d,null,{default:i(()=>[y("div",q,u(v.label),1),y("div",K,u(v.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}}),H=y("div",{class:"label"},"Created At:",-1),Q=y("div",{class:"label"},"Last Updated:",-1),X=c({__name:"EntityInfo",props:{entityDef:{},record:{}},setup(l){return(e,a)=>(s(),_(d,null,{default:i(()=>[n(d,{class:"col"},{default:i(()=>[H,n(B,{class:"label text-info-dark",value:e.record.createdAt},null,8,["value"])]),_:1}),n(d,{class:"col"},{default:i(()=>[Q,n(B,{class:"label text-info-dark",value:e.record.updatedAt},null,8,["value"])]),_:1})]),_:1}))}}),Y=c({__name:"EntityToolbar",props:{editMode:{type:Boolean}},emits:["edit","save","delete"],setup(l,{emit:e}){const a=e,t=l;return J(o=>{L(o,()=>{t.editMode&&a("save")})}),(o,p)=>(s(),_(d,{class:"toolbar col shrink"},{default:i(()=>[n(x,{speed:"fast"},{default:i(()=>[o.editMode?(s(),_(C,{key:0,icon:"save",size:"1",color:"success",onClick:p[0]||(p[0]=v=>o.$emit("save"))})):b("",!0)]),_:1}),n(x,{speed:"fast"},{default:i(()=>[o.editMode?(s(),_(C,{key:0,onClick:p[1]||(p[1]=v=>o.$emit("delete")),icon:"delete",size:"1",color:"error"})):b("",!0)]),_:1}),n(C,{onClick:p[2]||(p[2]=v=>o.$emit("edit",!o.editMode)),icon:o.editMode?"edit_off":"edit",label:"Edit Mode",color:"warning",size:"1"},null,8,["icon"])]),_:1}))}}),A=c({__name:"DisplayData",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),Z=c({__name:"DisplayInt",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ee=c({__name:"DisplayBigInt",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),te=c({__name:"DisplayDate",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),le=c({__name:"DisplayBoolean",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),se=c({__name:"DisplayPassword",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ae=c({__name:"DisplayChoices",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ne=c({__name:"DisplayMultiChoice",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ie=c({__name:"DisplayText",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),oe=c({__name:"DisplayEmail",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),re=c({__name:"DisplayImage",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ue=c({__name:"DisplayJSON",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),ce=c({__name:"DisplayPhone",props:{value:{},field:{}},setup(l){const e=l;return(a,t)=>(s(),r("div",null,u(e.value),1))}}),de=c({__name:"DisplayConnection",props:{value:{},field:{},titleValue:{}},setup(l){return(e,a)=>(s(),r("div",null,u(e.titleValue),1))}}),pe={IDField:A,DataField:A,IntField:Z,BigIntField:ee,DateField:te,BooleanField:le,PasswordField:se,ChoicesField:ae,MultiChoiceField:ne,TextField:ie,EmailField:oe,ImageField:re,JSONField:ue,PhoneField:ce,ConnectionField:de,TimestampField:U},_e={class:"title-4 text-primary"},fe={class:"text-small align-content-center bold"},ve={class:"text-medium align-content-center"},I=c({__name:"EntityFieldGroup",props:{group:{},edit:{type:Boolean},record:{}},setup(l){return(e,a)=>(s(),_(P,null,{default:i(()=>[n(d,{class:"row shrink"},{default:i(()=>[y("div",_e,u(e.group.title),1),n(F,{class:S(["group-fields column-gap-3",{edit:e.edit}])},{default:i(()=>[n(d,{class:"field-names"},{default:i(()=>[(s(!0),r(k,null,g(e.group.fields.filter(t=>!t.hidden),t=>(s(),r("div",fe,u(t.label),1))),256))]),_:1}),n(d,{class:"row field-values"},{default:i(()=>[(s(!0),r(k,null,g(e.group.fields,t=>(s(),r("div",ve,[(s(),_(z(h(pe)[t.fieldType]),{field:t,value:e.record[t.key]},null,8,["field","value"]))]))),256))]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}))}}),me={class:"title-4"},ye={class:"text-small italic text-primary-bright"},Ce=c({__name:"EntityRecordView",props:{entity:{},id:{}},setup(l){const e=l;let a={};const t=$({}),o={loaded:$(!1),saving:$(!1)},p=$(!1);async function v(){o.loaded.value=!1,t.value=await w.getEntity(e.entity,e.id),o.loaded.value=!0}async function M(){if(!t.value)return;o.saving.value=!0;const m=t.value;await w.updateEntity(e.entity,m.id,m),o.saving.value=!1}return G(e.entity,"update",async m=>{m.id===e.id&&(t.value=m,N({message:`${a.config.label} ${t.value[a.config.titleField||"id"]} was updated`,title:`${a.config.label} Updated`,type:"success"}))}),T(()=>{if(!e.id||!e.entity)return E.push("/entity");const m=O.getDef(e.entity);if(!m)return E.push("/entity");a=m}),V(async()=>{await v()}),(m,D)=>(s(),_(x,null,{default:i(()=>[o.loaded.value?(s(),_(F,{key:0,class:"position-relative entity-record-grid"},{default:i(()=>[n(d,{class:"top-bar col shrink vertical-align-center horizontal-align-between"},{default:i(()=>[n(d,null,{default:i(()=>[y("div",me,u(t.value[h(a).config.titleField||"id"]),1),y("div",ye,u(t.value.id),1)]),_:1}),n(Y,{editMode:p.value,onSave:M,onDelete:D[0]||(D[0]=()=>{}),onEdit:D[1]||(D[1]=f=>p.value=f)},null,8,["editMode"])]),_:1}),n(F,{class:"fields"},{default:i(()=>[n(d,{class:"row shrink"},{default:i(()=>[(s(!0),r(k,null,g(h(a).fieldGroups.filter(f=>f.key!=="default"),f=>(s(),_(I,{group:f,record:t.value,key:f.key},null,8,["group","record"]))),128)),(s(!0),r(k,null,g(h(a).fieldGroups.filter(f=>f.key==="default"),f=>(s(),_(I,{group:f,record:t.value,key:f.key},null,8,["group","record"]))),128))]),_:1})]),_:1}),n(d,{class:"info"},{default:i(()=>[n(X,{entityDef:h(a),record:t.value},null,8,["entityDef","record"])]),_:1}),n(d,{class:"actions"},{default:i(()=>[n(W,{entityDef:h(a),record:t.value},null,8,["entityDef","record"])]),_:1}),n(R,{loaded:!o.saving.value},null,8,["loaded"])]),_:1})):b("",!0)]),_:1}))}});export{Ce as default};
