import{a as d,G as g,s as P,o as a,c as _,w as i,h as y,b as n,l as o,L as k,M as h,C as c,k as F,t as u,n as S,i as b,p as z,e as N,q as $,U as T}from"./RootLayout.vue_vue_type_style_index_0_lang-C7NduuQ-.js";import{a as C,b as w,_ as x,l as G,r as E,e as L,c as R}from"./main-DT8Npkzz.js";import{C as V}from"./CardWidget-DR0gW1BQ.js";import{_ as B,l as U,o as J,a as O}from"./InputTimestamp.vue_vue_type_script_setup_true_lang-CDwwVY4G.js";import"./InputWrapper.vue_vue_type_script_setup_true_lang-D2qf8GVU.js";const j={class:"title-5 text-accent"},q={class:"text-small italic"},K=d({__name:"EntityActions",props:{entityDef:{},record:{}},setup(l){const e=l,s=g([]);P(()=>{s.value=e.entityDef.actions});async function t(r){const p=await w.runEntityAction(e.entityDef.entityId,e.record.id,r.key,{});S({title:`Action ${r.label||r.key} completed`,message:p,type:"success"})}return(r,p)=>(a(),_(F,{class:"row shrink"},{default:i(()=>[p[0]||(p[0]=y("div",null,[y("div",{class:"title-4"},"Actions")],-1)),n(c,{class:"row shrink"},{default:i(()=>[(a(!0),o(h,null,k(s.value,v=>(a(),_(V,{key:v.key},{default:i(()=>[n(c,{class:"col-2 shrink vertical-align-center"},{default:i(()=>[n(C,{icon:"play_arrow",color:"secondary",onClick:M=>t(v),label:v.label},null,8,["onClick","label"]),n(c,null,{default:i(()=>[y("div",j,u(v.label),1),y("div",q,u(v.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}))}}),W=d({__name:"EntityInfo",props:{entityDef:{},record:{}},setup(l){return(e,s)=>(a(),_(c,null,{default:i(()=>[n(c,{class:"col"},{default:i(()=>[s[0]||(s[0]=y("div",{class:"label"},"Created At:",-1)),n(B,{class:"label text-info-dark",value:e.record.createdAt},null,8,["value"])]),_:1}),n(c,{class:"col"},{default:i(()=>[s[1]||(s[1]=y("div",{class:"label"},"Last Updated:",-1)),n(B,{class:"label text-info-dark",value:e.record.updatedAt},null,8,["value"])]),_:1})]),_:1}))}}),H=d({__name:"EntityToolbar",props:{editMode:{type:Boolean}},emits:["edit","save","delete"],setup(l,{emit:e}){const s=e,t=l;return U(r=>{J(r,()=>{t.editMode&&s("save")})}),(r,p)=>(a(),_(c,{class:"toolbar col shrink"},{default:i(()=>[n(x,{speed:"fast"},{default:i(()=>[r.editMode?(a(),_(C,{key:0,icon:"save",size:"1",color:"success",onClick:p[0]||(p[0]=v=>r.$emit("save"))})):b("",!0)]),_:1}),n(x,{speed:"fast"},{default:i(()=>[r.editMode?(a(),_(C,{key:0,onClick:p[1]||(p[1]=v=>r.$emit("delete")),icon:"delete",size:"1",color:"error"})):b("",!0)]),_:1}),n(C,{onClick:p[2]||(p[2]=v=>r.$emit("edit",!r.editMode)),icon:r.editMode?"edit_off":"edit",label:"Edit Mode",color:"warning",size:"1"},null,8,["icon"])]),_:1}))}}),A=d({__name:"DisplayData",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),Q=d({__name:"DisplayInt",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),X=d({__name:"DisplayBigInt",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),Y=d({__name:"DisplayDate",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),Z=d({__name:"DisplayBoolean",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),ee=d({__name:"DisplayPassword",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),te=d({__name:"DisplayChoices",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),le=d({__name:"DisplayMultiChoice",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),se=d({__name:"DisplayText",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),ae=d({__name:"DisplayEmail",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),ne=d({__name:"DisplayImage",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),ie=d({__name:"DisplayJSON",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),re=d({__name:"DisplayPhone",props:{value:{},field:{}},setup(l){const e=l;return(s,t)=>(a(),o("div",null,u(e.value),1))}}),oe=d({__name:"DisplayConnection",props:{value:{},field:{},titleValue:{}},setup(l){return(e,s)=>(a(),o("div",null,u(e.titleValue),1))}}),ue={IDField:A,DataField:A,IntField:Q,BigIntField:X,DateField:Y,BooleanField:Z,PasswordField:ee,ChoicesField:te,MultiChoiceField:le,TextField:se,EmailField:ae,ImageField:ne,JSONField:ie,PhoneField:re,ConnectionField:oe,TimestampField:O},de={class:"title-4 text-primary"},ce={class:"text-small align-content-center bold"},pe={class:"text-medium align-content-center"},I=d({__name:"EntityFieldGroup",props:{group:{},edit:{type:Boolean},record:{}},setup(l){return(e,s)=>(a(),_(V,null,{default:i(()=>[n(c,{class:"row shrink"},{default:i(()=>[y("div",de,u(e.group.title),1),n(F,{class:z(["group-fields column-gap-3",{edit:e.edit}])},{default:i(()=>[n(c,{class:"field-names"},{default:i(()=>[(a(!0),o(h,null,k(e.group.fields.filter(t=>!t.hidden),t=>(a(),o("div",ce,u(t.label),1))),256))]),_:1}),n(c,{class:"row field-values"},{default:i(()=>[(a(!0),o(h,null,k(e.group.fields,t=>(a(),o("div",pe,[(a(),_(N($(ue)[t.fieldType]),{field:t,value:e.record[t.key]},null,8,["field","value"]))]))),256))]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}))}}),_e={class:"title-4"},fe={class:"text-small italic text-primary-bright"},ke=d({__name:"EntityRecordView",props:{entity:{},id:{}},setup(l){const e=l;let s={};const t=g({}),r={loaded:g(!1),saving:g(!1)},p=g(!1);async function v(){r.loaded.value=!1,t.value=await w.getEntity(e.entity,e.id),r.loaded.value=!0}async function M(){if(!t.value)return;r.saving.value=!0;const m=t.value;await w.updateEntity(e.entity,m.id,m),r.saving.value=!1}return G(e.entity,"update",async m=>{m.id===e.id&&(t.value=m,S({message:`${s.config.label} ${t.value[s.config.titleField||"id"]} was updated`,title:`${s.config.label} Updated`,type:"success"}))}),T(()=>{if(!e.id||!e.entity)return E.push("/entity");const m=L.getDef(e.entity);if(!m)return E.push("/entity");s=m}),P(async()=>{await v()}),(m,D)=>(a(),_(x,null,{default:i(()=>[r.loaded.value?(a(),_(F,{key:0,class:"position-relative entity-record-grid"},{default:i(()=>[n(c,{class:"top-bar col shrink vertical-align-center horizontal-align-between"},{default:i(()=>[n(c,null,{default:i(()=>[y("div",_e,u(t.value[$(s).config.titleField||"id"]),1),y("div",fe,u(t.value.id),1)]),_:1}),n(H,{editMode:p.value,onSave:M,onDelete:D[0]||(D[0]=()=>{}),onEdit:D[1]||(D[1]=f=>p.value=f)},null,8,["editMode"])]),_:1}),n(F,{class:"fields"},{default:i(()=>[n(c,{class:"row shrink"},{default:i(()=>[(a(!0),o(h,null,k($(s).fieldGroups.filter(f=>f.key!=="default"),f=>(a(),_(I,{group:f,record:t.value,key:f.key},null,8,["group","record"]))),128)),(a(!0),o(h,null,k($(s).fieldGroups.filter(f=>f.key==="default"),f=>(a(),_(I,{group:f,record:t.value,key:f.key},null,8,["group","record"]))),128))]),_:1})]),_:1}),n(c,{class:"info"},{default:i(()=>[n(W,{entityDef:$(s),record:t.value},null,8,["entityDef","record"])]),_:1}),n(c,{class:"actions"},{default:i(()=>[n(K,{entityDef:$(s),record:t.value},null,8,["entityDef","record"])]),_:1}),n(R,{loaded:!r.saving.value},null,8,["loaded"])]),_:1})):b("",!0)]),_:1}))}});export{ke as default};
