import{a as w,o as u,c as f,w as i,m as F,C as h,b as a,g as C,j as E,k as $,i as v,t as g,p as I,f as T,K as V,h as W,P as q,G as _,s as O,l as L,N,O as z,B as P,Q as U,_ as K}from"./Container-DH2J1Vin.js";import{_ as j,a as D,b as B,e as x,l as A,M as G,T as Q}from"./main-CPSzirzt.js";import{C as b}from"./CardWidget-t1ohyxJS.js";import{_ as R}from"./InputPassword.vue_vue_type_script_setup_true_lang-CrvKFhcI.js";import{l as H,_ as J}from"./EasyInput.vue_vue_type_script_setup_true_lang-CTnaj6NF.js";const X=w({__name:"ListDetailLayout",props:{maxWidth:{}},setup(m){return(r,e)=>(u(),f(h,{class:"list-detail",style:F(r.maxWidth?`--max-width:${r.maxWidth}`:"")},{default:i(()=>[a($,{class:"bg border"},{default:i(()=>[C(r.$slots,"list",{},()=>[E("List")])]),_:3}),a($,{class:"bg border"},{default:i(()=>[C(r.$slots,"detail",{},()=>[E("Detail")])]),_:3})]),_:3},8,["style"]))}}),Y={class:"text-small text-primary bold item-label"},Z=w({__name:"EntityListItem",props:{entityDef:{},record:{},active:{type:Boolean}},emits:["select"],setup(m,{emit:r}){return(e,c)=>(u(),f(b,{class:I(["full-width entity-list-item",{active:e.active}]),onClick:c[0]||(c[0]=d=>e.$emit("select",e.record.id))},{default:i(()=>[v("div",Y,g(e.record[e.entityDef.titleField||"id"]),1)]),_:1},8,["class"]))}}),ee=w({__name:"ModalView",props:{modelValue:{type:Boolean}},emits:["update:modelValue","close"],setup(m,{emit:r}){function e(){y.value=!1,d("close")}const c=m,d=r,y=T({get:()=>c.modelValue,set:n=>{d("update:modelValue",n)}});return H(n=>{n.key==="Escape"&&e()}),(n,l)=>(u(),f(q,{to:"#modals"},[a(j,null,{default:i(()=>[y.value?(u(),f(h,{key:0,onClick:V(e,["self"]),class:"modal-wrapper z-max position-fixed top left vh-100 vw-100 horizontal-align-center vertical-align-center"},{default:i(()=>[a(b,null,{default:i(()=>[C(n.$slots,"default",{},()=>[E(" modal ")])]),_:3})]),_:3})):W("",!0)]),_:3})]))}}),te={class:"title-3"},ae=w({__name:"NewEntityForm",props:{entityDef:{}},emits:["close"],setup(m,{emit:r}){function e(){s("close")}async function c(){if(!y())return;await B.createEntity(n.entityDef.entityId,l.value)&&e()}let d=[];function y(){let t=!0;return k.value={},d.forEach(o=>{l.value[o.key]||(k.value[o.key]="This field is required.",t=!1)}),t}const n=m,l=_({}),k=_({}),s=r;return O(()=>{d=n.entityDef.fields.filter(t=>t.required),d.forEach(t=>{t.defaultValue&&(l.value[t.key]=t.defaultValue)})}),(t,o)=>(u(),f($,{class:"row-gap-4"},{default:i(()=>[v("div",te," New "+g(t.entityDef.label),1),v("form",{onSubmit:o[0]||(o[0]=V(()=>{},["prevent"]))},[a(h,{class:"col-2 row-gap-4 column-gap-3"},{default:i(()=>[(u(!0),L(z,null,N(t.entityDef.fields.filter(p=>p.required),(p,M)=>(u(),f(J,{focus:M==0,field:p,error:k.value[p.key],modelValue:l.value[p.key],"onUpdate:modelValue":S=>l.value[p.key]=S,key:p.key},null,8,["focus","field","error","modelValue","onUpdate:modelValue"]))),128))]),_:1})],32),a(h,{class:"col shrink horizontal-align-center"},{default:i(()=>[a(D,{onClick:e,icon:"close",color:"error",size:"1"}),a(D,{type:"submit",onClick:V(c,["prevent"]),icon:"check",color:"success",size:"1"})]),_:1})]),_:1}))}}),ie={class:"title-3"},se={class:"position-relative"},le=w({__name:"EntityList",props:{entity:{},activeEntity:{}},emits:["select"],setup(m,{emit:r}){const e=m;function c(){y.value=!0}function d(){y.value=!1}const y=_(!1),n=_([]),l={entityDef:{},loading:_(!0),totalCount:_(0),currentCount:_(0),listOptions:P({filter:{},orderBy:"",order:"asc",limit:50,offset:0})};async function k(){const s=await B.getList(e.entity,l.listOptions);n.value=s.data,l.totalCount.value=s.totalCount,l.currentCount.value=s.rowCount}return U(async()=>{const s=x.entities.find(t=>t.entityId===e.entity);s&&(l.entityDef=s,await k())}),A(e.entity,"list",s=>{n.value.forEach((t,o)=>{t.id===s.id&&(n.value[o]=s)})}),(s,t)=>(u(),f($,{class:"entity-list-wrapper"},{default:i(()=>[v("div",ie,g(l.entityDef.label),1),a(b,null,{default:i(()=>[a(h,{class:"list-header col horizontal-align-between"},{default:i(()=>[v("div",se,[a(R,{name:"search",placeholder:"Search",focus:""}),a(G,{class:"position-absolute right pe-2 center-y",size:"1.2",icon:"search"})]),v("div",null,[a(D,{label:`New ${s.entity}`,onClick:c,icon:"add",size:"1"},null,8,["label"])])]),_:1})]),_:1}),a(h,{class:"list-container"},{default:i(()=>[(u(!0),L(z,null,N(n.value,o=>(u(),f(Z,{active:s.activeEntity==o.id,key:o.id,entityDef:l.entityDef,record:o,onSelect:t[0]||(t[0]=p=>s.$emit("select",p))},null,8,["active","entityDef","record"]))),128))]),_:1}),a(ee,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=o=>y.value=o)},{default:i(()=>[a(ae,{entityDef:l.entityDef,onClose:d},null,8,["entityDef"])]),_:1},8,["modelValue"])]),_:1}))}}),ne=w({__name:"EntityListView",props:{entity:{},id:{}},setup(m){const r=m;return(e,c)=>(u(),f(X,{maxWidth:"400px"},{list:i(()=>[a(le,{entity:e.entity,activeEntity:e.id,onSelect:c[0]||(c[0]=d=>e.$router.push(`/entity/${e.entity}/${d}`))},null,8,["entity","activeEntity"])]),detail:i(()=>[(u(),f(Q,{key:r.id}))]),_:1}))}}),fe=K(ne,[["__scopeId","data-v-dc27ec16"]]);export{fe as default};
