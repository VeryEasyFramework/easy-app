import{d as P,a as p,x as F,o as r,c as _,w as s,e as v,b as t,p as m,z as x,F as b,C as d,s as I,t as k,h as q,n as S,B as U,f as D,v as R,m as E,l as W,_ as z}from"./index-BYjH4yJH.js";import{_ as V,M as H}from"./ButtonIcon.vue_vue_type_script_setup_true_lang-Cbo9dm9r.js";import{C as N}from"./CardWidget-CLnvhoga.js";import{c as L,b as M,d as T}from"./EasyInput.vue_vue_type_script_setup_true_lang-BTbdhf5x.js";import{_ as G}from"./FormBase.vue_vue_type_script_setup_true_lang-CON9pmVo.js";import{_ as K}from"./TransitionList.vue_vue_type_style_index_0_lang-BLagXTsR.js";const O={class:"title-5 text-accent"},X={class:"text-small italic"},Y={class:"title-4 text-center"},ie=P({__name:"EntityActions",props:{entityDef:{},type:{},record:{}},setup(h){const c=h,y=p([]),a=p({key:"",label:"",description:"",params:[],action:()=>{}}),i=p({}),u=p(!1),f=p(!1);F(()=>{y.value=c.entityDef.actions.filter(o=>!o.private)});async function w(o,e=!1){if(a.value=o,o.params&&o.params.length>0){i.value={},o.params.forEach(l=>{i.value[l.key]={error:"",value:null}}),u.value=!0,f.value=e;return}await $(o,e)}async function $(o,e=!1){if(!B(o,i.value))return;const l={};for(const g in i.value)l[g]=i.value[g].value;let n={};switch(c.type){case"entity":n=await q.call("entity","runEntityAction",{entity:c.entityDef.entityId,id:c.record.id,action:o.key,data:l,enqueue:e});break;case"settings":n=await q.call("settings","runSettingsAction",{settings:c.entityDef.settingsId,action:o.key,data:l});break}S({title:`Action ${o.label||o.key} completed`,message:n.message||n||"Action completed",type:"success"}),i.value={},a.value={key:"",label:"",description:"",params:[],action:()=>{}},u.value=!1,f.value=!1}function B(o,e){let l=!1;if(!o.params)return!0;for(const n of o.params){if(n.required&&!e[n.key].value){e[n.key].error="Please provide a value",l=!0;continue}e[n.key].error=""}return!l}return(o,e)=>(r(),_(I,{class:"row shrink"},{default:s(()=>[e[3]||(e[3]=v("div",null,[v("div",{class:"title-4"},"Actions")],-1)),t(d,{class:"row shrink"},{default:s(()=>[(r(!0),m(b,null,x(y.value,l=>(r(),_(N,{key:l.key},{default:s(()=>[t(d,{class:"col-2 shrink vertical-align-center"},{default:s(()=>[t(V,{icon:"play_arrow",color:"secondary",onClick:n=>w(l),label:l.label,key:"play"},null,8,["onClick","label"]),t(V,{icon:"queue_play_next",color:"info",onClick:n=>w(l,!0),label:l.label,key:"queue"},null,8,["onClick","label"]),t(d,null,{default:s(()=>[v("div",O,k(l.label),1),v("div",X,k(l.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(L,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l)},{default:s(()=>[t(I,{class:"row row-gap-4"},{default:s(()=>[v("div",Y,k(a.value.label||a.value.key),1),t(G,{name:"actionParamsForm",onSubmitted:e[1]||(e[1]=async()=>await $(a.value,f.value))},{default:s(()=>[t(d,{class:"row row-gap-4"},{default:s(()=>[t(d,null,{default:s(()=>[(r(!0),m(b,null,x(a.value.params,l=>(r(),m("div",{key:l.key},[t(M,{field:l,editable:"",modelValue:i.value[l.key].value,"onUpdate:modelValue":n=>i.value[l.key].value=n,error:i.value[l.key].error},null,8,["field","modelValue","onUpdate:modelValue","error"])]))),128))]),_:1}),t(d,{class:"col shrink horizontal-align-center gap-3"},{default:s(()=>[t(V,{icon:"cancel",color:"error",onClick:e[0]||(e[0]=l=>u.value=!1),label:"Cancel"}),t(V,{icon:f.value?"queue_play_next":"play_arrow",type:"submit",color:f.value?"info":"secondary",label:a.value.label},null,8,["icon","color","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),j={key:0,class:"title-4 text-primary"},J={key:1,class:"title-6 pb-2 italic"},re=P({__name:"EntityFieldGroup",props:{group:{},edit:{type:Boolean},record:{}},setup(h){const c=h,y=U(()=>c.group.fields.filter(a=>{var i;return!(a.hidden||(i=a.fetchOptions)!=null&&i.thisIdKey)}));return(a,i)=>(r(),_(N,{class:""},{default:s(()=>[t(d,{class:"row shrink"},{default:s(()=>[a.group.key!="default"?(r(),m("div",j,k(a.group.title),1)):D("",!0),a.group.description?(r(),m("div",J,k(a.group.description),1)):D("",!0),t(d,{class:R(["group-fields col shrink column-gap-3 overflow-hidden",{edit:a.edit}])},{default:s(()=>[t(d,{class:"col-2 field-values"},{default:s(()=>[(r(!0),m(b,null,x(y.value,u=>(r(),_(d,{key:`${u.key}value`},{default:s(()=>[t(M,{editable:a.edit,field:u,modelValue:a.record[u.key],"onUpdate:modelValue":f=>a.record[u.key]=f},null,8,["editable","field","modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}))}}),Q={class:"label"},Z=P({__name:"Popover",props:{text:{},wait:{},position:{}},setup(h){const c=h,y=p("0px"),a=p("0px");p(null);const i=p();F(()=>{});const u=p(!1);function f(){var e;(e=i.value)==null||e.showPopover()}function w(){var e;(e=i.value)==null||e.hidePopover()}function $(e){var l,n;u.value=!0,o((n=(l=e.target)==null?void 0:l.firstElementChild)==null?void 0:n.getBoundingClientRect(),i.value),setTimeout(()=>{u.value&&f()},c.wait??300)}function B(){u.value=!1,setTimeout(()=>{w()},c.wait??300)}function o(e,l){if(!e)return;const n=l.offsetHeight,g=l.offsetWidth;let C,A;window.innerHeight-(e==null?void 0:e.top)<n?A=(e==null?void 0:e.top)-n:A=e==null?void 0:e.top,window.innerWidth-(e==null?void 0:e.left)<g?C=(e==null?void 0:e.left)+g+5:C=(e==null?void 0:e.left)+(e==null?void 0:e.width)+5,l.style.top=`${A}px`,l.style.left=`${C}px`,y.value=`${A}px`,a.value=`${C}px`}return(e,l)=>(r(),m(b,null,[v("div",{style:{display:"contents"},onMouseenter:$,onMouseleave:B},[E(e.$slots,"default")],32),v("div",{ref_key:"popover",ref:i,class:"popover",popover:""},[E(e.$slots,"popover",{},()=>[t(N,{class:"shadow"},{default:s(()=>[v("div",Q,k(e.text),1)]),_:1})])],512)],64))}}),ee=P({__name:"RecordAttendance",props:{users:{}},setup(h){return(c,y)=>(r(),_(d,{class:"col shrink overflow-visible"},{default:s(()=>[t(K,null,{default:s(()=>[(r(!0),m(b,null,x(c.users,a=>(r(),_(d,{key:a.id,class:"col shrink"},{default:s(()=>[t(Z,{text:`${a.firstName} ${a.lastName}`},{default:s(()=>[(r(),_(d,{class:"col cursor-pointer label overflow-visible avatar shrink vertical-align-center bg-primary border px-2",key:a.id},{default:s(()=>[t(H,{icon:"person",class:"avatar"}),v("div",null,k(W(T)(`${a.firstName} ${a.lastName}`,"initials")),1)]),_:2},1024))]),_:2},1032,["text"])]),_:2},1024))),128))]),_:1})]),_:1}))}}),ue=z(ee,[["__scopeId","data-v-8aced524"]]);export{ue as R,ie as _,re as a};
