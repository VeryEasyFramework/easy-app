import{a as _,G as g,s as S,o as t,c as m,w as r,h as $,b as n,l as u,K as w,L as C,C as f,k as F,t as p,n as z,e as T,q as b,i as E,p as N,O as U}from"./RootLayout.vue_vue_type_style_index_0_lang-BZeep0iS.js";import{_ as D,a as M,b as A,l as G,r as V,e as L,c as O}from"./main-C4r8M_Zo.js";import{C as q}from"./CardWidget-CgoUrGzA.js";import{a as R,_ as B,l as J,o as K}from"./ModalView.vue_vue_type_style_index_0_lang-DzWgMhIj.js";import{_ as j}from"./Form.vue_vue_type_script_setup_true_lang-DoFSUf2T.js";import{i as W,_ as H}from"./index-BIgFuRNA.js";import"./InputPassword.vue_vue_type_script_setup_true_lang-ChpjvxUz.js";const Q={class:"title-5 text-accent"},X={class:"text-small italic"},Y={class:"title-4 text-center"},Z=_({__name:"EntityActions",props:{entityDef:{},record:{}},setup(a){const e=a,s=g([]),l=g({key:"",label:"",description:"",params:[],action:()=>{}}),o=g({}),v=g(!1);S(()=>{s.value=e.entityDef.actions.filter(c=>!c.private)});async function h(c){if(l.value=c,c.params&&c.params.length>0){o.value={},c.params.forEach(i=>{o.value[i.key]={error:"",value:null}}),v.value=!0;return}await x(c)}async function x(c){if(!y(c,o.value))return;const i={};for(const k in o.value)i[k]=o.value[k].value;const d=await M.runEntityAction(e.entityDef.entityId,e.record.id,c.key,i);z({title:`Action ${c.label||c.key} completed`,message:d.message||d||"Action completed",type:"success"}),o.value={},l.value={key:"",label:"",description:"",params:[],action:()=>{}},v.value=!1}function y(c,i){let d=!1;if(!c.params)return!0;for(const k of c.params){if(k.required&&!i[k.key].value){i[k.key].error="Please provide a value",d=!0;continue}i[k.key].error=""}return!d}return(c,i)=>(t(),m(F,{class:"row shrink"},{default:r(()=>[i[3]||(i[3]=$("div",null,[$("div",{class:"title-4"},"Actions")],-1)),n(f,{class:"row shrink"},{default:r(()=>[(t(!0),u(C,null,w(s.value,d=>(t(),m(q,{key:d.key},{default:r(()=>[n(f,{class:"col-2 shrink vertical-align-center"},{default:r(()=>[n(D,{icon:"play_arrow",color:"secondary",onClick:k=>h(d),label:d.label,key:"play"},null,8,["onClick","label"]),n(f,null,{default:r(()=>[$("div",Q,p(d.label),1),$("div",X,p(d.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(R,{modelValue:v.value,"onUpdate:modelValue":i[2]||(i[2]=d=>v.value=d)},{default:r(()=>[n(F,{class:"row row-gap-4"},{default:r(()=>[$("div",Y,p(l.value.label||l.value.key),1),n(j,{name:"actionParamsForm",onSubmitted:i[1]||(i[1]=async()=>await x(l.value))},{default:r(()=>[n(f,{class:"row row-gap-4"},{default:r(()=>[n(f,null,{default:r(()=>[(t(!0),u(C,null,w(l.value.params,d=>(t(),u("div",{key:d.key},[(t(),m(T(b(W)[d.fieldType]),{label:d.key,required:d.required,error:o.value[d.key].error,modelValue:o.value[d.key].value,"onUpdate:modelValue":k=>o.value[d.key].value=k},null,8,["label","required","error","modelValue","onUpdate:modelValue"]))]))),128))]),_:1}),n(f,{class:"col shrink horizontal-align-center gap-3"},{default:r(()=>[n(D,{icon:"cancel",color:"error",onClick:i[0]||(i[0]=d=>v.value=!1),label:"Cancel"}),n(D,{icon:"play_arrow",type:"submit",color:"secondary",label:l.value.label},null,8,["label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ee=_({__name:"EntityInfo",props:{entityDef:{},record:{}},setup(a){return(e,s)=>(t(),m(f,null,{default:r(()=>[n(f,{class:"col"},{default:r(()=>[s[0]||(s[0]=$("div",{class:"label"},"Created At:",-1)),n(B,{class:"label text-info-dark",value:e.record.createdAt},null,8,["value"])]),_:1}),n(f,{class:"col"},{default:r(()=>[s[1]||(s[1]=$("div",{class:"label"},"Last Updated:",-1)),n(B,{class:"label text-info-dark",value:e.record.updatedAt},null,8,["value"])]),_:1})]),_:1}))}}),le=_({__name:"EntityToolbar",props:{editMode:{type:Boolean}},emits:["edit","save","delete"],setup(a,{emit:e}){const s=e,l=a;return J(o=>{K(o,()=>{l.editMode&&s("save")})}),(o,v)=>(t(),m(f,{class:"toolbar col shrink"},{default:r(()=>[n(A,{speed:"fast"},{default:r(()=>[o.editMode?(t(),m(D,{key:0,icon:"save",size:"1",color:"success",onClick:v[0]||(v[0]=h=>o.$emit("save"))})):E("",!0)]),_:1}),n(A,{speed:"fast"},{default:r(()=>[o.editMode?(t(),m(D,{key:0,onClick:v[1]||(v[1]=h=>o.$emit("delete")),icon:"delete",size:"1",color:"error"})):E("",!0)]),_:1}),n(D,{onClick:v[2]||(v[2]=h=>o.$emit("edit",!o.editMode)),icon:o.editMode?"edit_off":"edit",label:"Edit Mode",color:"warning",size:"1"},null,8,["icon"])]),_:1}))}}),P=_({__name:"DisplayData",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),te=_({__name:"DisplayInt",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),ae=_({__name:"DisplayBigInt",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),se=_({__name:"DisplayDate",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),ne=_({__name:"DisplayBoolean",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),re=_({__name:"DisplayPassword",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),ie=_({__name:"DisplayChoices",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),oe=_({__name:"DisplayMultiChoice",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),ue=_({__name:"DisplayText",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),de=_({__name:"DisplayEmail",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),ce=_({__name:"DisplayImage",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),pe=_({__name:"DisplayJSON",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),_e=_({__name:"DisplayPhone",props:{value:{},field:{}},setup(a){const e=a;return(s,l)=>(t(),u("div",null,p(e.value),1))}}),fe=_({__name:"DisplayConnection",props:{value:{},field:{},titleValue:{}},setup(a){return(e,s)=>(t(),u("div",null,p(e.titleValue),1))}}),ve={IDField:P,DataField:P,IntField:te,BigIntField:ae,DateField:se,BooleanField:ne,PasswordField:re,ChoicesField:ie,MultiChoiceField:oe,TextField:ue,EmailField:de,ImageField:ce,JSONField:pe,PhoneField:_e,ConnectionField:fe,TimestampField:H},me={class:"title-4 text-primary"},ye={class:"text-small align-content-center bold"},ke={class:"text-medium align-content-center"},I=_({__name:"EntityFieldGroup",props:{group:{},edit:{type:Boolean},record:{}},setup(a){return(e,s)=>(t(),m(q,null,{default:r(()=>[n(f,{class:"row shrink"},{default:r(()=>[$("div",me,p(e.group.title),1),n(F,{class:N(["group-fields column-gap-3",{edit:e.edit}])},{default:r(()=>[n(f,{class:"field-names"},{default:r(()=>[(t(!0),u(C,null,w(e.group.fields.filter(l=>!l.hidden),l=>(t(),u("div",ye,p(l.label),1))),256))]),_:1}),n(f,{class:"row field-values"},{default:r(()=>[(t(!0),u(C,null,w(e.group.fields,l=>(t(),u("div",ke,[(t(),m(T(b(ve)[l.fieldType]),{field:l,value:e.record[l.key]},null,8,["field","value"]))]))),256))]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}))}}),$e={class:"title-4"},ge={class:"text-small italic text-primary-bright"},Ee=_({__name:"EntityRecordView",props:{entity:{},id:{}},setup(a){const e=a;let s={};const l=g({}),o={loaded:g(!1),saving:g(!1)},v=g(!1);async function h(){o.loaded.value=!1,l.value=await M.getEntity(e.entity,e.id),o.loaded.value=!0}async function x(){if(!l.value)return;o.saving.value=!0;const y=l.value;await M.updateEntity(e.entity,y.id,y),o.saving.value=!1}return G(e.entity,"update",async y=>{y.id===e.id&&(l.value=y,z({message:`${s.config.label} ${l.value[s.config.titleField||"id"]} was updated`,title:`${s.config.label} Updated`,type:"success"}))}),U(()=>{if(!e.id||!e.entity)return V.push("/entity");const y=L.getDef(e.entity);if(!y)return V.push("/entity");s=y}),S(async()=>{await h()}),(y,c)=>(t(),m(A,null,{default:r(()=>[o.loaded.value?(t(),m(F,{key:0,class:"position-relative entity-record-grid"},{default:r(()=>[n(f,{class:"top-bar col shrink vertical-align-center horizontal-align-between"},{default:r(()=>[n(f,null,{default:r(()=>[$("div",$e,p(l.value[b(s).config.titleField||"id"]),1),$("div",ge,p(l.value.id),1)]),_:1}),n(le,{editMode:v.value,onSave:x,onDelete:c[0]||(c[0]=()=>{}),onEdit:c[1]||(c[1]=i=>v.value=i)},null,8,["editMode"])]),_:1}),n(F,{class:"fields"},{default:r(()=>[n(f,{class:"row shrink"},{default:r(()=>[(t(!0),u(C,null,w(b(s).fieldGroups.filter(i=>i.key!=="default"),i=>(t(),m(I,{group:i,record:l.value,key:i.key},null,8,["group","record"]))),128)),(t(!0),u(C,null,w(b(s).fieldGroups.filter(i=>i.key==="default"),i=>(t(),m(I,{group:i,record:l.value,key:i.key},null,8,["group","record"]))),128))]),_:1})]),_:1}),n(f,{class:"info"},{default:r(()=>[n(ee,{entityDef:b(s),record:l.value},null,8,["entityDef","record"])]),_:1}),n(f,{class:"actions"},{default:r(()=>[n(Z,{entityDef:b(s),record:l.value},null,8,["entityDef","record"])]),_:1}),n(O,{loaded:!o.saving.value},null,8,["loaded"])]),_:1})):E("",!0)]),_:1}))}});export{Ee as default};
