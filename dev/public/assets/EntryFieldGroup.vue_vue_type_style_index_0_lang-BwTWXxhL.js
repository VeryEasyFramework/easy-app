import{d as P,a as c,x as M,o as i,c as _,w as s,e as v,b as t,p as y,z as x,F as b,C as d,s as N,t as k,h as q,n as U,m as E,l as I,_ as R,B as W,f as F,v as z}from"./index-CS0ctzBO.js";import{_ as V,M as H}from"./ButtonIcon.vue_vue_type_script_setup_true_lang-CJazxrdG.js";import{C as B}from"./CardWidget-CZble4Vm.js";import{c as L,b as S,d as D}from"./EasyInput.vue_vue_type_script_setup_true_lang-DyZPaHgo.js";import{_ as G}from"./FormBase.vue_vue_type_script_setup_true_lang-D9V7oIsE.js";import{_ as K}from"./TransitionList.vue_vue_type_style_index_0_lang-DHrpeRMs.js";const O={class:"title-5 text-accent"},X={class:"text-small italic"},Y={class:"title-4 text-center"},re=P({__name:"EntryActions",props:{entryType:{},type:{},entry:{}},setup(h){const p=h,m=c([]),a=c({key:"",label:"",description:"",params:[],action:()=>{}}),r=c({}),u=c(!1),f=c(!1);M(()=>{m.value=p.entryType.actions.filter(o=>!o.private)});async function w(o,e=!1){if(a.value=o,o.params&&o.params.length>0){r.value={},o.params.forEach(l=>{r.value[l.key]={error:"",value:null}}),u.value=!0,f.value=e;return}await $(o,e)}async function $(o,e=!1){if(!T(o,r.value))return;const l={};for(const g in r.value)l[g]=r.value[g].value;let n={};switch(p.type){case"entry":n=await q.call("entry","runEntryAction",{entryType:p.entryType.entryType,id:p.entry.id,action:o.key,data:l,enqueue:e});break;case"settings":n=await q.call("settings","runSettingsAction",{settingsType:p.entryType.settingsType,action:o.key,data:l});break}U({title:`Action ${o.label||o.key} completed`,message:n.message||n||"Action completed",type:"success"}),r.value={},a.value={key:"",label:"",description:"",params:[],action:()=>{}},u.value=!1,f.value=!1}function T(o,e){let l=!1;if(!o.params)return!0;for(const n of o.params){if(n.required&&!e[n.key].value){e[n.key].error="Please provide a value",l=!0;continue}e[n.key].error=""}return!l}return(o,e)=>(i(),_(N,{class:"row shrink"},{default:s(()=>[e[3]||(e[3]=v("div",null,[v("div",{class:"title-4"},"Actions")],-1)),t(d,{class:"row shrink"},{default:s(()=>[(i(!0),y(b,null,x(m.value,l=>(i(),_(B,{key:l.key},{default:s(()=>[t(d,{class:"col-2 shrink vertical-align-center"},{default:s(()=>[t(V,{icon:"play_arrow",color:"secondary",onClick:n=>w(l),label:l.label,key:"play"},null,8,["onClick","label"]),t(V,{icon:"queue_play_next",color:"info",onClick:n=>w(l,!0),label:l.label,key:"queue"},null,8,["onClick","label"]),t(d,null,{default:s(()=>[v("div",O,k(l.label),1),v("div",X,k(l.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),t(L,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l)},{default:s(()=>[t(N,{class:"row row-gap-4"},{default:s(()=>[v("div",Y,k(a.value.label||a.value.key),1),t(G,{name:"actionParamsForm",onSubmitted:e[1]||(e[1]=async()=>await $(a.value,f.value))},{default:s(()=>[t(d,{class:"row row-gap-4"},{default:s(()=>[t(d,null,{default:s(()=>[(i(!0),y(b,null,x(a.value.params,l=>(i(),y("div",{key:l.key},[t(S,{field:l,editable:!0,modelValue:r.value[l.key].value,"onUpdate:modelValue":n=>r.value[l.key].value=n,error:r.value[l.key].error},null,8,["field","modelValue","onUpdate:modelValue","error"])]))),128))]),_:1}),t(d,{class:"col shrink horizontal-align-center gap-3"},{default:s(()=>[t(V,{icon:"cancel",color:"error",onClick:e[0]||(e[0]=l=>u.value=!1),label:"Cancel"}),t(V,{icon:f.value?"queue_play_next":"play_arrow",type:"submit",color:f.value?"info":"secondary",label:a.value.label},null,8,["icon","color","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),j={class:"label"},J=P({__name:"Popover",props:{text:{},wait:{},position:{}},setup(h){const p=h,m=c("0px"),a=c("0px");c(null);const r=c();M(()=>{});const u=c(!1);function f(){var e;(e=r.value)==null||e.showPopover()}function w(){var e;(e=r.value)==null||e.hidePopover()}function $(e){var l,n;u.value=!0,o((n=(l=e.target)==null?void 0:l.firstElementChild)==null?void 0:n.getBoundingClientRect(),r.value),setTimeout(()=>{u.value&&f()},p.wait??300)}function T(){u.value=!1,setTimeout(()=>{w()},p.wait??300)}function o(e,l){if(!e)return;const n=l.offsetHeight,g=l.offsetWidth;let C,A;window.innerHeight-(e==null?void 0:e.top)<n?A=(e==null?void 0:e.top)-n:A=e==null?void 0:e.top,window.innerWidth-(e==null?void 0:e.left)<g?C=(e==null?void 0:e.left)+g+5:C=(e==null?void 0:e.left)+(e==null?void 0:e.width)+5,l.style.top=`${A}px`,l.style.left=`${C}px`,m.value=`${A}px`,a.value=`${C}px`}return(e,l)=>(i(),y(b,null,[v("div",{style:{display:"contents"},onMouseenter:$,onMouseleave:T},[E(e.$slots,"default")],32),v("div",{ref_key:"popover",ref:r,class:"popover",popover:""},[E(e.$slots,"popover",{},()=>[t(B,{class:"shadow"},{default:s(()=>[v("div",j,k(e.text),1)]),_:1})])],512)],64))}}),Q=P({__name:"RecordAttendance",props:{users:{}},setup(h){return(p,m)=>(i(),_(d,{class:"col shrink overflow-visible"},{default:s(()=>[t(K,null,{default:s(()=>[(i(!0),y(b,null,x(p.users,a=>(i(),_(d,{key:a.id,class:"col shrink"},{default:s(()=>[t(J,{text:`${a.firstName} ${a.lastName}`},{default:s(()=>[(i(),_(d,{class:"col cursor-pointer label overflow-visible avatar shrink vertical-align-center bg-primary border px-2",key:a.id},{default:s(()=>[t(H,{icon:"person",class:"avatar"}),v("div",null,k(I(D)(`${a.firstName} ${a.lastName}`,"initials")),1)]),_:2},1024))]),_:2},1032,["text"])]),_:2},1024))),128))]),_:1})]),_:1}))}}),ie=R(Q,[["__scopeId","data-v-8aced524"]]),Z={key:0,class:"title-4 text-primary"},ee={key:1,class:"title-6 pb-2 italic"},ue=P({__name:"EntryFieldGroup",props:{group:{},edit:{type:Boolean},entry:{}},setup(h){const p=h,m=W(()=>p.group.fields.filter(a=>{var r;return!(a.hidden||(r=a.fetchOptions)!=null&&r.thisIdKey)}));return(a,r)=>(i(),_(B,{class:""},{default:s(()=>[t(d,{class:"row shrink"},{default:s(()=>[a.group.key!="default"?(i(),y("div",Z,k(a.group.title),1)):F("",!0),a.group.description?(i(),y("div",ee,k(a.group.description),1)):F("",!0),t(d,{class:z(["group-fields col shrink column-gap-3 overflow-hidden",{edit:a.edit}])},{default:s(()=>[t(d,{class:"col-2 field-values"},{default:s(()=>[(i(!0),y(b,null,x(m.value,u=>(i(),_(d,{key:`${u.key}value`},{default:s(()=>[t(S,{editable:a.edit,field:u,modelValue:a.entry[u.key],"onUpdate:modelValue":f=>a.entry[u.key]=f},null,8,["editable","field","modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1})]),_:1},8,["class"])]),_:1})]),_:1}))}});export{ie as R,re as _,ue as a};
